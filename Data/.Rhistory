da = data_iris[, data_iris$Species == "virginica"]
da = data_iris[data_iris$Species == "virginica", ]
mean(da$Sepal.Length)
sd(da$Sepal.Width)
library(readr)
library(readr)
US_EPA_data_2017 <- read_csv("C:/Karan/HU/Anly 506/US EPA data 2017.csv")
View(US_EPA_data_2017)
mean(US_EPA_data_2017$`Observation Count`)
library(tidyverse)
unique(US_EPA_data_2017$`State Name`)
a <- c(3,4,7,8)
b <- c(5,7,7,6)
fm <- matrix(c(a,b), byrow=T, nrow=2)
dist(fm, method = "Manhattan")
dist(fm, method = "Manhattan")
dist(fm, method = "manhattan")
dist(fm, method = "euclidean")
?dist
library("shiny", lib.loc="~/R/win-library/3.5")
data <- read.csv("C:/Karan/HU/Anly 512/EasternSchools.csv")
View(data)
knitr::opts_chunk$set(echo = TRUE)
nms<-names(data)
cats<-names(data[ ,c(2,3,5,6,13)]) # subset of columns
cats<-names(data[ ,c(3,19,20,25)]) # subset of columns
install.packages("plotly")
install.packages("cluster")
library(cluster)
df <- USArrests
df <- na.omit(df)
df <- scale(df)
hc2 <- agnes(df, method = "single")
hc2
hc2$ac
round(hc2$ac, 2)
df <- USArrests
df <- na.omit(df)
df <- scale(df)
d <- dist(df, method = "euclidean")
hc1 <- hclust(d, method = "ward.D" )
plot(hc1, cex = 0.6, hang = -1)
plot(hc1)
##Importing the dataset
setwd("C:/Users/Karab/Documents/GitHub/ANLY-506-91-O/Data")
data = read.csv("gapminder.csv")
##Data preparation
names(data) <- c("Country", "Year", "Life Exp", "Population", "Income", "Region")
data$Population = as.character(data$Population)
data$Population = as.numeric(data$Population)
##Understanding the data
str(data)
#Subsetting the data
data[complete.cases(data[, 4]), ]
summary(data)
View(data)
#Subsetting the data
data = data[complete.cases(data[, 4]), ]
data = read.csv("gapminder.csv")
##Data preparation
names(data) <- c("Country", "Year", "Life Exp", "Population", "Income", "Region")
data$Population = as.character(data$Population)
data$Population = as.numeric(data$Population)
data1 = subset(data, year >= 1950)
data1 = subset(data, Year >= 1950)
is.na(data1)
View(data1)
rm(data1)
#Questions
1. How has the population increased over the last 6 decades in different regions?
2. Which are the top 10 countries by population according to the last census data?
3. Is there a correlation between life expectancy and income levels?
4. How does the income levels varies between the regions?
5.
years = rep(1800:2015, 10)
years = seq(1800, 2015, by = 10)
data1 = subset(data, Year = years)
library(ggplot2)
rm(data1)
library(tidyverse)
ggplot(data = data, mapping = aes(x = data$Region, y = data$Income)) +
geom_boxplot()
View(data)
View(data)
data1 = subset(data, Year >=1950)
ggplot(data = data1, mapping = aes(x = data$Region, y = data$Income)) +
geom_boxplot()
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income)) +
geom_boxplot()
data1 = subset(data, Year =2015)
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income)) +
geom_boxplot()
data1 %>% filter(Year = 2015)
data1 = data %>% filter(Year = 2015)
rm(data1)
data1 <- data %>% group_by(Country)
data1 <- data %>% filter(Year = 2015)
data1 <- data %>% filter(Year = "2015")
data1 <- data %>% filter(Country == "India")
View(data1)
data1 <- data %>% filter(Region == "India")
data1 <- data %>% filter(Region == "South Asia")
View(data1)
data1 <- data %>% filter(Region == "South Asia") %>% filter(Year == 2015)
View(data1)
View(data)
levels(data$Region)
data1 <- data %>% filter(Region == "South Asia" | Region == "East Asia & Pacific") %>% filter(Year == 2015)
View(data1)
data1 <- data %>% filter(Region == "South Asia" | Region == "East Asia & Pacific") %>% filter(Year == 2010)
View(data1)
data1 <- data %>% filter(Region == "America") %>% filter(Year == 2010)
View(data1)
data1 <- data %>% filter(Region == "South Asia") %>% filter(Year == 2010)
View(data1)
ggplot(data = data1, mapping = aes(x = data1$Country, y = data1$Income)) +
geom_boxplot()
data1 <- data %>% filter(Year == 2010)
ggplot(data = data1, mapping = aes(x = data1$Country, y = data1$Income)) +
geom_boxplot()
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income)) +
geom_boxplot()
View(data1)
max(data1$Income)
library(ggplot2)
data1[max(data1$Income), ]
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$`Life Exp`)) +
geom_boxplot()
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income)) +
geom_boxplot()
data1$Income = data1$Income/1000
View(data1)
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income)) +
geom_boxplot()
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income)) +
geom_boxplot() + ggtitle(Income distribtuion by Region)
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income)) +
geom_boxplot() + ggtitle("Income distribtuion by Region")
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income)) +
geom_boxplot() + ggtitle("Income distribtuion by Region") + xlab("Region") + ylab("Income in thousands")
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region)) +
geom_boxplot() + ggtitle("Income distribtuion by Region") +
xlab("Region") +
ylab("Income in thousands")
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region)) +
geom_boxplot() + ggtitle("Income distribtuion by Region") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=14, face="bold.italic"),
axis.title.y = element_text(color="#993333", size=14, face="bold.italic")
)
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region)) +
geom_boxplot() + ggtitle("Income distribtuion by Region") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=8, face="bold.italic"),
axis.title.y = element_text(color="blue", size=8, face="bold.italic")
)
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region)) +
geom_boxplot() + ggtitle("Income distribtuion by Region") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
) +
geom_label()
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region, label=Country)) +
geom_boxplot() + ggtitle("Income distribtuion by Region") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
) +
geom_label()
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region, label= Country)) +
geom_boxplot() + ggtitle("Income distribtuion by Region") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
) +
geom_label(data = max(data1$Income))
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region, label= Country)) +
geom_boxplot() + ggtitle("Income distribtuion by Region") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
data2 <- data %>% filter(Year == 2015)
data2 <- data %>% filter(Year == 2010)
ggplot(data1, aes(x=data1$Income, y=data1$`Life Exp`, color=data1$Region)) +
geom_point(shape=1) +
ggplot(data1, aes(x=data1$Income, y=data1$`Life Exp`, color=data1$Region)) +
geom_point(shape=1)
ggplot(data = data1, aes(x=data1$Income, y=data1$`Life Exp`, color=data1$Region)) +
geom_point(shape=1)
ggplot(data = data1, aes(x=data1$Income, y=data1$`Life Exp`, fill=data1$Region)) +
geom_point(shape=data1$Region)
ggplot(data = data1, aes(x=data1$Income, y=data1$`Life Exp`, col=data1$Region)) +
geom_point(shape=data1$Region)
ggplot(data = data1, aes(x=data1$Income, y=data1$`Life Exp`, col=data1$Region)) +
geom_point(shape=2)
ggplot(data = data1, aes(x=data1$Income, y=data1$`Life Exp`, col=data1$Region)) +
geom_point()
ggplot(data = data1, aes(x=data1$`Life Exp`, y=data1$Income, col=data1$Region)) +
geom_point()
ggplot(data = data1, aes(x=data1$Income, y=data1$`Life Exp`, col=data1$Region)) +
geom_point()+
ggtitle("Relation between Income and Life Expectancy in 2010") +
xlab("Region in thousands") +
ylab("Life Expectancy") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
ggplot(data = data1, aes(x=data1$Income, y=data1$`Life Exp`, col=data1$Region)) +
geom_point()+
ggtitle("Relation between Income and Life Expectancy in 2010") +
xlab("Region in thousands") +
ylab("Life Expectancy") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
) +
geom_label()
ggplot(data = data1, aes(x=data1$Income, y=data1$`Life Exp`, col=data1$Region, label = data1$Country)) +
geom_point()+
ggtitle("Relation between Income and Life Expectancy in 2010") +
xlab("Region in thousands") +
ylab("Life Expectancy") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
) +
geom_label()
ggplot(data = data1, aes(x=data1$Income, y=data1$`Life Exp`, col=data1$Region)) +
geom_point()+
ggtitle("Relation between Income and Life Expectancy in 2010") +
xlab("Region in thousands") +
ylab("Life Expectancy") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
) +
geom_label()
ggplot(data = data1, aes(x=data1$Income, y=data1$`Life Exp`, col=data1$Region)) +
geom_point()+
ggtitle("Relation between Income and Life Expectancy in 2010") +
xlab("Region in thousands") +
ylab("Life Expectancy") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region, label= Country)) +
geom_boxplot() + ggtitle("Income distribtuion by Region in 2010") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Population, fill= Region) +
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Population, fill= Region) +
ggplot(data = data1, aes(x=data1$Income, y=data1$`Life Exp`, col=data1$Region)) +
geom_point()+
ggtitle("Relation between Income and Life Expectancy in 2010") +
xlab("Region in thousands") +
ylab("Life Expectancy") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
ggplot(data = data1, aes(x=data1$Income, y=data1$`Life Exp`, col=data1$Region)) +
geom_point()+
ggtitle("Relation between Income and Life Expectancy in 2010") +
xlab("Region in thousands") +
ylab("Life Expectancy") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region, label= Country)) +
geom_boxplot() + ggtitle("Income distribtuion by Region in 2010") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Population, fill= Region, label= Country)) +
geom_boxplot() + ggtitle("Income distribtuion by Region in 2010") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Population, fill= Region, label= Country)) +
geom_boxplot() + ggtitle("Income distribtuion by Region in 2010") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
) +
geom_label()
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Population, fill= Region, label= Country)) +
geom_boxplot() + ggtitle("Income distribtuion by Region in 2010") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
) +
geom_label()
data1 <- data %>% filter(Year == 2015)
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Population, fill= Region, label= Country)) +
geom_boxplot() + ggtitle("Income distribtuion by Region in 2010") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
) +
geom_label()
data1 <- data %>% filter(Year == 2010)
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region, label= Country)) +
geom_boxplot() + ggtitle("Income distribtuion by Region in 2010") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
) +
geom_label()
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region)) +
geom_boxplot() + ggtitle("Income distribtuion by Region in 2010") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
ggplot(data = data1, aes(x=data1$Income, y=data1$`Life Exp`, col=data1$Region)) +
geom_point()+
ggtitle("Relation between Income and Life Expectancy in 2010") +
xlab("Region in thousands") +
ylab("Life Expectancy") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
data1 <- data %>% filter(Year == 2010)
data1$Income = data1$Income/1000
ggplot(data = data1, aes(x=data1$Income, y=data1$`Life Exp`, col=data1$Region)) +
geom_point()+
ggtitle("Relation between Income and Life Expectancy in 2010") +
xlab("Income in thousands") +
ylab("Life Expectancy") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
rm(data2)
data2 = data %>% filter(Country == "Qatar")
ggplot(data = data2, aes(x = data2$Year, y = data2$Income)) +
geom_line()
data3 = data %>% filter(Country == "Qatar") %>% filter(Year >= 1950)
ggplot(data = data3, aes(x = data2$Year, y = data2$Income)) +
geom_line()
ggplot(data = data3, aes(x = data3$Year, y = data3$Income)) +
geom_line()
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region)) +
geom_boxplot() + ggtitle("Income distribtuion by Region in 2010") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
data4= data %>% filter(Region == "Middle East & North Africa")
levels(data4$Country)
View(data4)
levels(data4$Country)
data4$Country
class(data4$Country)
data4= data %>% filter(Region == "Middle East & North Africa") %>% filter(Year == 2010)
View(data4)
data4= data %>% filter(Region == "Middle East & North Africa") %>% filter(Year == 2010) %>% arrange(Income = desc())
data4= data %>% filter(Region == "Middle East & North Africa") %>% filter(Year == 2010) %>% arrange(desc(Income))
View(data4)
data4= data %>% filter(Region == "Middle East & North Africa") %>% filter(Year == 2010) %>% top_n(x = Income, n = 10)
View(data4)
data4= data %>% filter(Region == "Middle East & North Africa") %>% filter(Year == 2010) %>% top_n(x = data4$Income, n = 10)
data4= data %>% filter(Region == "Middle East & North Africa") %>% filter(Year == 2010) %>% arrange(desc(Income))
View(data4)
data4 = data4[10, ]
View(data4)
data4 = data4[1:10, ]
View(data4)
data4= data %>% filter(Region == "Middle East & North Africa") %>% filter(Year == 2010) %>% arrange(desc(Income))
data4 = data4[1:10, ]
View(data4)
ggplot(data = data4, aes(x = data4$Year, y = data4$Income, col=data4$Country)) +
geom_line()
data4= data %>% filter(Region == "Middle East & North Africa") %>% arrange(desc(Income))
data4 = data4[1:10, ]
data4= data %>% filter(Region == "Middle East & North Africa") %>% arrange(desc(Income))
View(data4)
data4= data %>% filter(Region == "Middle East & North Africa") %>% filter(Year == 2010) %>% arrange(desc(Income))
data4 = data4[1:10, ]
View(data4)
ggplot(data = data4, aes(x = data4$Year, y = data4$Income, col=data4$Country)) +
geom_bar()
ggplot(data = data4, aes(x = data4$Country, y = data4$Income, col=data4$Country)) +
geom_bar(stat = "Identity")
ggplot(data = data4, aes(x = data4$Country, y = data4$Income, fill=data4$Country)) +
geom_bar(stat = "Identity")
ggplot(data = data, aes(x = data$Year, y = data$Population) +
ggplot(data = data, aes(x = data$Year, y = data$Population, fill = Region) +
geom_line()
ggplot(data = data, aes(x = data$Year, y = data$Population, fill = Region)) +
geom_line()
ggplot(data = data, aes(x = data$Year, y = data$Population, fill = Region)) +
geom_area()
data5 = data %>% filter(Year >= 2000)
ggplot(data = data5, aes(x = data$Year, y = data$Population, fill = Region)) +
geom_area()
data5 = data %>% filter(Year >= 2000)
ggplot(data = data5, aes(x = data5$Year, y = data5$Population, fill = Region)) +
geom_area()
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region)) +
geom_boxplot() + ggtitle("Income distribtuion by Region in 2010") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
par(mfrow=c(1,2))
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region)) +
geom_boxplot() + ggtitle("Income distribtuion by Region in 2010") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Population, fill= Region)) +
geom_boxplot() + ggtitle("Population distribtuion by Region in 2010") +
xlab("Region") +
ylab("Population") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
par(mfrow=c(1,2))
ggplot(data = data1, mapping = aes(x = data1$Region, y = data1$Income, fill= Region)) +
geom_boxplot() + ggtitle("Income distribtuion by Region in 2010") +
xlab("Region") +
ylab("Income in thousands") +
theme(
plot.title = element_text(color="red", size=14, face="bold"),
axis.title.x = element_text(color="blue", size=10, face="bold.italic"),
axis.title.y = element_text(color="blue", size=10, face="bold.italic")
)
data4= data %>% filter(Region == "Middle East & North Africa") %>% filter(Year == 2010)
View(data4)
data4= data %>% filter(Region == "Middle East & North Africa")
ggplot(data = data4, aes(x = data4$Country, y = data4$Income, fill=data4$Country)) +
geom_bar(stat = "Identity")
data4= data %>% filter(Region == "Middle East & North Africa")
data4 = data4[1:10, ]
View(data4)
data4= data %>% filter(Region == "Middle East & North Africa") %>% filter(Year == 2010) %>% arrange(desc(Income))
data4 = data4[1:10, ]
View(data4)
